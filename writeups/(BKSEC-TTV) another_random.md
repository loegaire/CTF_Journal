---
title: anothe_random

---

another_random writeup
ta có 2 file: chal.py và leak.txt 
chal.py khá ngắn:
```
from Crypto.Util.number import long_to_bytes
import random
from hashlib import sha256

rng = random.Random()
FLAG = 'BKSEC{' + sha256(long_to_bytes(rng.getrandbits(1024))).hexdigest() + '}'
leak = [rng.getrandbits(1024) for i in range(20)]

with open('leak.txt', 'w') as f:
    f.write(str(leak) + '\n')
```
sau khi tìm kiếm trên mạng về lỗ hổng của python random.Random(), em được biết đến cách sử dụng mt19937_predictor
tải thư viện trên Arch: 
`pipx install mt19937-predictor`
làm theo những gì đề bài cho: 
from mt19937predictor import MT19937Predictor
from Crypto.Util.number import long_to_bytes
from hashlib import sha256

# code: 
```
leaked_values = [164205116280066994817275129941880573630766594784448045366229063385708405802736300499391754536512676946491094389668141425370132832994519546909051066662211760950893417903717733953594591400734501591006569930978353754018097832167872358288482606218385427477143720862049111942209071602707814129986757459307790652773, 241630362948671680031586972982084809796842062845608188083942396006484649816668904532827376850415830941278629788850862794319158125351699453956869673660007601145395807728764460701422576646993518344214145148622845822680368969936129034893378510089616719330043117117824728268900921965682431500238616196627354245, 178547188665256408092079805397994765162057332595379605250926331150399976258565737536647642188410977131090712434400038557156994156014681401059966775156360924464597242805517367505050228929725026275609652824431950327487102838162585452205435468652215121174308390973485569124736145201716971995930559470758649548076, 118476066886532334983271741049962260882050345947011782001994365956445537977668356844321587650927566273538676949256017572867602464433548204080563018098778591746620134726954408177321826780375248661615120977841765101366916180133985099596123983490212732507286285676888095028554373124499674347424556480135343221272, 83684038025721825530946713994092459248083672717860696040127171990621544964054374529614348843087010582270059659293943759413907652085299157788495077451326634661906530763668077549355896647615398722295276088570903698703854944372813698983544272557022025600866560209178854842255698052916969934986651885405104881723, 116102687608744432227841307112514065959743443098552432289170038016793325003644692891065239569526824954244758829697693975791867990102797278590226769864489736314442894044221413073883631413141884247662754976617199189625017603487504829155502531909447206783036876799281002769581153924926062588258174248737325946164, 138242819319839869901192093217802356909161833383474920604915354208990494537619365428317456970653394981451612398553984399796485659642160950370631700031563036678122150438899248700963473358864285288710381579228146807550755746071257761087051748251893365033553008613625634477211296964625656978151283269454518910525, 34140571245516986934888759580189529235147294337574693715203460828981944751881287227372678969200727749319726335378769054544954562644209087346264473253894165909511067980221112270915299567449561196951734600476294200045127356554385689957026775471125696755000275073571981960975751255786853019339753484413170389361, 131979705202880089441301576684534439164556914040541193278928452892011524355954672719537576654960953580911740342430191146298407239790779522405632138060997868208316039525929910569427098276972696062326370133297308354168929868769476050607826166934200327074743639223112529577029454388370738405037208999161026226942, 38994885386770584975708304291053530244923433261164881919933378157959325902835803570571862623707297594412326697436588273437159560155402359847173083260213468170026002246609552305960814281017078642011843065125924578354482529765693839495464610967102757470780764966545592749719546290839340983526280563311129507351, 83364006876892375956331924910807424776309233770641156554765713037817129426151701239570860196210869389873179990413475184430936173861854979725804828339307229506983951677602709995921464408991493337729171020721582987829774677540124751704066994458481692774474310045776285214702603994156402487610529367265479362797, 17022153079653215400444987430153426619718262076937022140571528592930273401658868779478054442836487826054958661797713330297303706007630673080410984946554747434986562923287453444591129994001504543197330369872839657332134219958769595774674328170811555423119503075592998843977203193616367984424943852588612246866, 175543689631610378895884231160614383470332421178436792446559042379694022692898010537384969267606642981306401788604789168090534508068299979111087542191022386538417494336379432806936267436593974340825887218539915433185754409330888263497184113344122326845331149449639958995580332810664747786895117578334042819889, 135868556115179257713002383483078205859446812487248734385790862008665123466416279474672593358419375602283221528073408330671991368470027701862832828277263531989898490408126244513331983117026776320359496309920957505316989443073717371138800751523979127889283280092906655947198931670639417071139379605505245223511, 33821294567924660465705739671327341790363171240331051277203652214858483405548212194893139559079265028058912022669351041176065261319746107507804609548881231388964047508717220565841424697257168511183550287380732962363106548613409610028372466393784129183645175727528767017312607353509267734227607055232945133019, 66828161252392428296182614723678999635398849479257049415548199354106607730407516216704892224121800964305152464457120707933062746360959716479182329794300314164689201948335577796689801291645250297838037204979446251416814827265540487893637916443328530973483129469430598019578808239702359856751400937585277817624, 98737068507503633910075798865196463495423206181273958783587524337682978736765949590802672642907207616987626081944560810311205502347538456310258738519263376322312622507945987658328126570354517826772125521193007303319169539121401686461459551703111169900854394444811195744122274213304181436746510735508202639982, 27535398778017246780684626809531885253338218398889751338339777280519575759655192668248537659855796115015450897248013962995035580587180999432259044510450154278443356058603041891607533180952561851929041412178834803207509036892345344453882963361801809053469408768984730443429755656214097247071868977115374124880, 40377581519658132438525635074543421456176974073544217753914151178093003488431551839133882036112453555708777912788425843274836993647648699406143332065042489205642526916435867674995917913327364984555592361400811457390946983375192821310136991019650852377104748909097521607060772894114346520259624362645923435408, 127991422123970739202904377427903836776159731868912855213493983477283408439344177099267664114066253603467147691411710295363981509992231177174110448837509094290221505892909903605650864452801057114422564606317293676481400830155989368587672327860795246601740901133247012202565600376795015396775283378991071442477]
predictor = MT19937Predictor()

for value in leaked_values:
    predictor.setrandbits(value, 1024)  # We know these values are 1024 bits

predicted_value = predictor.getrandbits(1024)

flag = "BKSEC{" + sha256(long_to_bytes(predicted_value)).hexdigest() + "}"

print("flag:", flag)
```
output trả về một flag sai. Em chuyển hướng sang bài khác để bài này nghĩ sau...